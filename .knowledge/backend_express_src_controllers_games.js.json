{"is_source_file": true, "format": "JavaScript", "description": "This file defines the GamesController class which manages game-related HTTP request handlers, including retrieving game details, submitting moves, resignation, and draw offers within a chess platform. It interacts with a database for storing game states, moves, and ratings, and uses WebSocket broadcasting to notify clients of game updates.", "external_files": ["../db/pool", "../chess/engine", "../ratings/elo", "../ws/hub"], "external_methods": ["query", "validateAndApplySanMove", "computeEloDelta", "broadcastToGame", "getPool"], "published": ["GamesController"], "classes": [{"name": "GamesController", "description": "Controller class handling game state operations such as move submission, game retrieval, resignation, and draw offers."}], "methods": [{"name": "getGame(req, res, next)", "description": "Fetches details of a specific game if the requesting user is a player in the game.", "scope": "GamesController", "scopeKind": "class"}, {"name": "getMoves(req, res, next)", "description": "Retrieves the move list for a specific game if the requesting user is a player in the game.", "scope": "GamesController", "scopeKind": "class"}, {"name": "submitMove(req, res, next)", "description": "Validates and records a player's move, updates game state, handles checkmate/stalemate detection, and broadcasts the move.", "scope": "GamesController", "scopeKind": "class"}, {"name": "resign(req, res, next)", "description": "Handles a player's resignation, declares the opponent as the winner, updates ratings, and broadcasts the game conclusion.", "scope": "GamesController", "scopeKind": "class"}, {"name": "draw(req, res, next)", "description": "Offers a draw, updates game state, ratings, and broadcasts the game result.", "scope": "GamesController", "scopeKind": "class"}, {"name": "_finalizeRatingsWithClient(client, game, { draw = false } = {})", "description": "Updates player ratings based on game outcome, using Elo calculation.", "scope": "GamesController", "scopeKind": "class"}], "calls": ["query", "validateAndApplySanMove", "computeEloDelta", "broadcastToGame", "getPool", "client.query", "client.release"], "search-terms": ["GamesController", "submitMove", "resign", "draw", "game_moves", "game_id"], "state": 2, "file_id": 24, "knowledge_revision": 66, "git_revision": "4bf3b08cca2bd752d1f5cacf8e9ac32b0d077815", "revision_history": [{"56": ""}, {"60": ""}, {"64": ""}, {"65": ""}, {"66": "4bf3b08cca2bd752d1f5cacf8e9ac32b0d077815"}], "ctags": [{"_type": "tag", "name": "GamesController", "path": "/home/kavia/workspace/code-generation/chess-mastery-platform-309890-309901/backend_express/src/controllers/games.js", "pattern": "/^class GamesController {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "_finalizeRatingsWithClient", "path": "/home/kavia/workspace/code-generation/chess-mastery-platform-309890-309901/backend_express/src/controllers/games.js", "pattern": "/^  async _finalizeRatingsWithClient(client, game, { draw = false } = {}) {$/", "language": "JavaScript", "kind": "method", "signature": "(client, game, { draw = false } = {})", "scope": "GamesController", "scopeKind": "class"}, {"_type": "tag", "name": "draw", "path": "/home/kavia/workspace/code-generation/chess-mastery-platform-309890-309901/backend_express/src/controllers/games.js", "pattern": "/^  async draw(req, res, next) {$/", "language": "JavaScript", "kind": "method", "signature": "(req, res, next)", "scope": "GamesController", "scopeKind": "class"}, {"_type": "tag", "name": "exports", "path": "/home/kavia/workspace/code-generation/chess-mastery-platform-309890-309901/backend_express/src/controllers/games.js", "pattern": "/^module.exports = new GamesController();$/", "language": "JavaScript", "kind": "variable", "scope": "module", "scopeKind": "class"}, {"_type": "tag", "name": "getGame", "path": "/home/kavia/workspace/code-generation/chess-mastery-platform-309890-309901/backend_express/src/controllers/games.js", "pattern": "/^  async getGame(req, res, next) {$/", "language": "JavaScript", "kind": "method", "signature": "(req, res, next)", "scope": "GamesController", "scopeKind": "class"}, {"_type": "tag", "name": "getMoves", "path": "/home/kavia/workspace/code-generation/chess-mastery-platform-309890-309901/backend_express/src/controllers/games.js", "pattern": "/^  async getMoves(req, res, next) {$/", "language": "JavaScript", "kind": "method", "signature": "(req, res, next)", "scope": "GamesController", "scopeKind": "class"}, {"_type": "tag", "name": "resign", "path": "/home/kavia/workspace/code-generation/chess-mastery-platform-309890-309901/backend_express/src/controllers/games.js", "pattern": "/^  async resign(req, res, next) {$/", "language": "JavaScript", "kind": "method", "signature": "(req, res, next)", "scope": "GamesController", "scopeKind": "class"}, {"_type": "tag", "name": "submitMove", "path": "/home/kavia/workspace/code-generation/chess-mastery-platform-309890-309901/backend_express/src/controllers/games.js", "pattern": "/^  async submitMove(req, res, next) {$/", "language": "JavaScript", "kind": "method", "signature": "(req, res, next)", "scope": "GamesController", "scopeKind": "class"}], "hash": "6fb24fe482a6d3d56f13971ed02916df", "format-version": 4, "code-base-name": "backend_express", "filename": "backend_express/src/controllers/games.js", "fields": [{"name": "module.exports = new GamesController();", "scope": "module", "scopeKind": "class", "description": "unavailable"}]}