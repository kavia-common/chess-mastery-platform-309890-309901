{"is_source_file": true, "format": "JavaScript", "description": "Source code defining the GamesController class for managing chess games, moves, and ratings in a backend Express server. It includes methods for retrieving game info, submitting moves, resigning, drawing, and rating updates.", "external_files": ["../db/pool", "../chess/engine", "../ratings/elo", "../ws/hub"], "external_methods": ["require('../db/pool').getPool", "validateAndApplySanMove", "computeEloDelta", "broadcastToGame"], "published": ["new GamesController()"], "classes": [{"name": "GamesController", "description": "Controller class handling endpoints related to chess games, moves, resignations, draws, and rating updates in a backend server."}], "methods": [{"name": "getGame(req, res, next)", "description": "Retrieves full details of a specific game if the requesting user is a participant.", "scope": "GamesController", "scopeKind": "class"}, {"name": "getMoves(req, res, next)", "description": "Retrieves the list of moves for a specific game, accessible only to participating users.", "scope": "GamesController", "scopeKind": "class"}, {"name": "submitMove(req, res, next)", "description": "Validates and applies a move in an active game, updates game state, computes ratings if game ends, and broadcasts move info.", "scope": "GamesController", "scopeKind": "class"}, {"name": "resign(req, res, next)", "description": "Handles a player resignation, marks the game as finished, updates ratings, and broadcasts the game end.", "scope": "GamesController", "scopeKind": "class"}, {"name": "draw(req, res, next)", "description": "Handles a draw offer acceptance, ends the game as a draw, updates ratings, and broadcasts the result.", "scope": "GamesController", "scopeKind": "class"}, {"name": "_finalizeRatingsWithClient(client, game, { draw = false } = {})", "description": "Updates players' ratings based on game outcome, using Elo calculations within a database transaction.", "scope": "GamesController", "scopeKind": "class"}], "calls": ["query", "validateAndApplySanMove", "computeEloDelta", "broadcastToGame", "require('../db/pool').getPool().connect()"], "search-terms": ["games controller", "submit move", "resign", "draw", "rating update", "game fetching", "move validation", "elo rating", "broadcast game"], "state": 2, "file_id": 24, "knowledge_revision": 65, "git_revision": "", "revision_history": [{"56": ""}, {"60": ""}, {"64": ""}, {"65": ""}], "ctags": [{"_type": "tag", "name": "GamesController", "path": "/home/kavia/workspace/code-generation/chess-mastery-platform-309890-309901/backend_express/src/controllers/games.js", "pattern": "/^class GamesController {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "_finalizeRatingsWithClient", "path": "/home/kavia/workspace/code-generation/chess-mastery-platform-309890-309901/backend_express/src/controllers/games.js", "pattern": "/^  async _finalizeRatingsWithClient(client, game, { draw = false } = {}) {$/", "language": "JavaScript", "kind": "method", "signature": "(client, game, { draw = false } = {})", "scope": "GamesController", "scopeKind": "class"}, {"_type": "tag", "name": "draw", "path": "/home/kavia/workspace/code-generation/chess-mastery-platform-309890-309901/backend_express/src/controllers/games.js", "pattern": "/^  async draw(req, res, next) {$/", "language": "JavaScript", "kind": "method", "signature": "(req, res, next)", "scope": "GamesController", "scopeKind": "class"}, {"_type": "tag", "name": "exports", "path": "/home/kavia/workspace/code-generation/chess-mastery-platform-309890-309901/backend_express/src/controllers/games.js", "pattern": "/^module.exports = new GamesController();$/", "language": "JavaScript", "kind": "variable", "scope": "module", "scopeKind": "class"}, {"_type": "tag", "name": "getGame", "path": "/home/kavia/workspace/code-generation/chess-mastery-platform-309890-309901/backend_express/src/controllers/games.js", "pattern": "/^  async getGame(req, res, next) {$/", "language": "JavaScript", "kind": "method", "signature": "(req, res, next)", "scope": "GamesController", "scopeKind": "class"}, {"_type": "tag", "name": "getMoves", "path": "/home/kavia/workspace/code-generation/chess-mastery-platform-309890-309901/backend_express/src/controllers/games.js", "pattern": "/^  async getMoves(req, res, next) {$/", "language": "JavaScript", "kind": "method", "signature": "(req, res, next)", "scope": "GamesController", "scopeKind": "class"}, {"_type": "tag", "name": "resign", "path": "/home/kavia/workspace/code-generation/chess-mastery-platform-309890-309901/backend_express/src/controllers/games.js", "pattern": "/^  async resign(req, res, next) {$/", "language": "JavaScript", "kind": "method", "signature": "(req, res, next)", "scope": "GamesController", "scopeKind": "class"}, {"_type": "tag", "name": "submitMove", "path": "/home/kavia/workspace/code-generation/chess-mastery-platform-309890-309901/backend_express/src/controllers/games.js", "pattern": "/^  async submitMove(req, res, next) {$/", "language": "JavaScript", "kind": "method", "signature": "(req, res, next)", "scope": "GamesController", "scopeKind": "class"}], "hash": "0425a7f54d4253a531d3d69d2bb34397", "format-version": 4, "code-base-name": "backend_express", "filename": "backend_express/src/controllers/games.js", "fields": [{"name": "module.exports = new GamesController();", "scope": "module", "scopeKind": "class", "description": "unavailable"}]}